version: 2

machine:
    environment:
          ANDROID_HOME: /usr/local/android-sdk-linux
          JAVA6_HOME: /usr/lib/jvm/java-6-openjdk-amd64
    java:
        version: openjdk8
dependencies:
    override:
            - echo y | sudo apt-get update
            - echo y | sudo apt-get install libpango-1.0-0
            - echo y | sudo apt-get install openjdk-6-jre

            - echo y | android update sdk --no-ui --all --filter tools,platform-tools,build-tools-23.0.3,android-23,extra-google-m2repository,extra-google-google_play_services,extra-android-support
            - ANDROID_HOME=/usr/local/android-sdk-linux ./gradlew dependencies      
jobs:
  build:     
    docker:
    - image: beevelop/ionic 
    steps:
    - checkout
    - run:
        name: Install node modules
        command: npm install
    - run:
        name: Building android
        command: ionic cordova build android
    - store_artifacts:
        path: platforms/android/build/outputs/apk/android-debug.apk